{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["const Connection = require(\"./connection.js\")\r\n\r\nclass Blitz {\r\n\r\n  /**\r\n   * Merge default options with client options\r\n   */\r\n  constructor(options) {\r\n    this.connecting = null\r\n    this.options = Object.assign({\r\n\r\n      // Resource Config\r\n      api_url: \"http://localhost:3010/\",\r\n      auth_url: \"http://localhost:3030/\",\r\n\r\n      // Connection Config\r\n      namespace: '/',\r\n\r\n      // Authorization Config\r\n      user_key: null,\r\n      user_secret: null,\r\n      ignore_limiter: false\r\n    }, options)\r\n\r\n    // Remove \"/\" from url's\r\n    let api = this.options.api_url\r\n    let auth = this.options.auth_url\r\n    this.options.api_url = api[api.length - 1] === \"/\" ? api.slice(0, -1) : api\r\n    this.options.auth_url = auth[auth.length - 1] === \"/\" ? auth.slice(0, -1) : auth\r\n\r\n    this.connect()\r\n  }\r\n\r\n\r\n  /**\r\n   * Connect by getting tokens and setting up clients\r\n   */\r\n  async connect() {\r\n    this.connection = new Connection(this.options)\r\n    this.connecting = this.connection.connect()\r\n    await this.connecting\r\n    this.connecting = null\r\n  }\r\n\r\n\r\n  /**\r\n   * Subscribe to certain endpoints\r\n   */\r\n  async subscribe(endpoint) {\r\n    await this.connecting\r\n    this.emit(\"subscribe\", endpoint)\r\n  }\r\n\r\n\r\n  /**\r\n   * Event listening for socket.io\r\n   */\r\n  async on(ev, func) {\r\n    await this.connecting\r\n    this.connection.client.on(ev, func)\r\n  }\r\n\r\n\r\n  /**\r\n   * Expose Socket client emit\r\n   */\r\n  async emit(ev, data) {\r\n    await this.connecting\r\n    this.connection.client.emit(ev, data)\r\n  }\r\n\r\n\r\n  /**\r\n   * RESTful methods for manual interaction\r\n   */\r\n  async query(verb, query) {\r\n    await this.connecting\r\n    return this.connection.request(verb, query)\r\n  }\r\n\r\n  get(query) {\r\n    return this.query(\"GET\", query)\r\n  }\r\n\r\n  post(url, body) {\r\n    let query = {\r\n      url: url,\r\n      body: body\r\n    }\r\n    return this.query(\"POST\", query)\r\n  }\r\n\r\n  put(url, body) {\r\n    let query = {\r\n      url: url,\r\n      body: body\r\n    }\r\n    return this.query(\"PUT\", query)\r\n  }\r\n\r\n  patch(url, body) {\r\n    let query = {\r\n      url: url,\r\n      body: body\r\n    }\r\n    return this.query(\"PATCH\", query)\r\n  }\r\n\r\n  delete(url, body) {\r\n    let query = {\r\n      url: url,\r\n      body: body\r\n    }\r\n    return this.query(\"DELETE\", query)\r\n  }\r\n}\r\n\r\nmodule.exports = Blitz\r\n"],"names":["Connection","require","Blitz","options","connecting","Object","assign","api","api_url","auth","auth_url","length","slice","connect","connection","endpoint","emit","ev","func","client","on","data","verb","query","request","url","body","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,aAAaC,QAAQ,iBAAR,CAAnB;IAEMC;iBAKQC,OAAZ,EAAqB;;SACdC,UAAL,GAAkB,IAAlB;SACKD,OAAL,GAAeE,OAAOC,MAAP,CAAc;eAGlB,wBAHkB;gBAIjB,wBAJiB;iBAOhB,GAPgB;gBAUjB,IAViB;mBAWd,IAXc;sBAYX;KAZH,EAaZH,OAbY,CAAf;QAgBII,MAAM,KAAKJ,OAAL,CAAaK,OAAvB;QACIC,OAAO,KAAKN,OAAL,CAAaO,QAAxB;SACKP,OAAL,CAAaK,OAAb,GAAuBD,IAAIA,IAAII,MAAJ,GAAa,CAAjB,MAAwB,GAAxB,GAA8BJ,IAAIK,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAA9B,GAAiDL,GAAxE;SACKJ,OAAL,CAAaO,QAAb,GAAwBD,KAAKA,KAAKE,MAAL,GAAc,CAAnB,MAA0B,GAA1B,GAAgCF,KAAKG,KAAL,CAAW,CAAX,EAAc,CAAC,CAAf,CAAhC,GAAoDH,IAA5E;SAEKI,OAAL;;;;;;;;;;qBAQKC,UAAL,GAAkB,IAAId,UAAJ,CAAe,KAAKG,OAApB,CAAlB;qBACKC,UAAL,GAAkB,KAAKU,UAAL,CAAgBD,OAAhB,EAAlB;;uBACM,KAAKT;;qBACNA,UAAL,GAAkB,IAAlB;;;;;;;;;;;;;;;;6EAOcW;;;;;;uBACR,KAAKX;;qBACNY,IAAL,CAAU,WAAV,EAAuBD,QAAvB;;;;;;;;;;;;;;;;6EAOOE,IAAIC;;;;;;uBACL,KAAKd;;qBACNU,UAAL,CAAgBK,MAAhB,CAAuBC,EAAvB,CAA0BH,EAA1B,EAA8BC,IAA9B;;;;;;;;;;;;;;;;6EAOSD,IAAII;;;;;;uBACP,KAAKjB;;qBACNU,UAAL,CAAgBK,MAAhB,CAAuBH,IAAvB,CAA4BC,EAA5B,EAAgCI,IAAhC;;;;;;;;;;;;;;;;6EAOUC,MAAMC;;;;;;uBACV,KAAKnB;;kDACJ,KAAKU,UAAL,CAAgBU,OAAhB,CAAwBF,IAAxB,EAA8BC,MAA9B;;;;;;;;;;;;;;;2BAGLA,OAAO;aACF,KAAKA,KAAL,CAAW,KAAX,EAAkBA,KAAlB,CAAP;;;;yBAGGE,KAAKC,MAAM;UACVH,QAAQ;aACLE,GADK;cAEJC;OAFR;aAIO,KAAKH,KAAL,CAAW,MAAX,EAAmBA,KAAnB,CAAP;;;;wBAGEE,KAAKC,MAAM;UACTH,QAAQ;aACLE,GADK;cAEJC;OAFR;aAIO,KAAKH,KAAL,CAAW,KAAX,EAAkBA,KAAlB,CAAP;;;;0BAGIE,KAAKC,MAAM;UACXH,QAAQ;aACLE,GADK;cAEJC;OAFR;aAIO,KAAKH,KAAL,CAAW,OAAX,EAAoBA,KAApB,CAAP;;;;4BAGKE,KAAKC,MAAM;UACZH,QAAQ;aACLE,GADK;cAEJC;OAFR;aAIO,KAAKH,KAAL,CAAW,QAAX,EAAqBA,KAArB,CAAP;;;;;AAIJI,OAAOC,OAAP,GAAiB1B,KAAjB"}